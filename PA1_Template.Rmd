---
output: 
  html_document: 
    fig_caption: yes
    keep_md: yes
---
----
output: 
  html_document: 
    keep_md: yes
----
Coursera Project File: PA1_Template.Rmd
========================
##Garrett Richardson
##PA1_Template.Rmd
##Source File: "Activity.csv"

This is my first R markdown project

Loading and preprocessing the data

Load the file, "activity.csv" in R
```{r}
data <- read.csv("activity.csv", header=T)
```

Remove NA values from the file
```{r}
data <- na.omit(data)
```

Create a histogram of the total total number of steps take per day.
```{r}
steps_day <- tapply(data$steps, data$date, sum)
hist(steps_day, main = "Steps", ylab="frequency", 
     xlab="Total Steps", col="blue", breaks=10)
```


Find the mean and median number of steps taken each day
```{r, echo=FALSE}
mean_steps <- aggregate(data$steps ~ data$date, data, mean)
median_steps <- aggregate(data$steps ~ data$date, data, median)
```

A time series plot of the average number of steps
```{r, echo=FALSE}
interval_steps <- aggregate(steps~interval, data, mean)
plot(interval_steps$interval, interval_steps$steps, type="l", 
     main="Avg Steps", xlab="Interval", ylab="Steps", col="blue")
```

Find the interval containing the maximum number of steps
```{r, echo=FALSE}
interval_max <- interval_steps[which.max(interval_steps$steps), 1]
interval_max
```
Create code to impute missing data
```{r, echo=FALSE}
data_NA <- read.csv("activity.csv", header=TRUE)
total_data_NA <- sum(is.na(data_NA$steps))
total_data_NA
input.mean <- data_NA
input.mean[is.na(input.mean$steps), 1] <- mean(data_NA$steps, na.rm=TRUE)
```
Histogram of total number of steps from imputed data
```{r, echo=FALSE}
steps_day_imputed <- tapply(input.mean$steps, input.mean$date, sum)
hist(steps_day_imputed, main = "Steps", ylab="frequency", 
     xlab="Total Steps", col="blue", breaks=10)
mean_steps_imputed <- aggregate(input.mean$steps ~ input.mean$date, input.mean, mean)
median_steps_imputed <- aggregate(data$steps ~ data$date, data, median)
```

Avg number of steps panel plot of weekends vs weekdays 
```{r, echo=FALSE}
input.mean$wday <-weekdays(as.Date(input.mean$date))
input.mean$wday[input.mean$wday=="Sunday" | input.mean$wday == "Saturday"]<-"weekend"
input.mean$wday[input.mean$wday!="weekend"] <-"weekday"
input.mean$wday <-as.factor(input.mean$wday)

library(lattice)
xyplot(steps ~ interval | wday, data=input.mean,
       layout = c(1,2), type = "1", col = "red", 
       xlab="Interval", ylab="Number of Steps", 
       ylim=c(-15,240),
       panel = function(x, y, ...){
         panel.average(x,y,...,horizontal=FALSE)
       })
```
